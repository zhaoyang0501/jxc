
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="format-detection" content="telephone=no">
        <title>FrozenUI Demo</title>
        <link rel="stylesheet" href="./frozenui/css/frozen.css">
        <link rel="stylesheet" href="./css/demo.css">
        <script src="./frozenui/lib/zepto.min.js"></script>
        <script src="./frozenui/js/frozen.js"></script>
    </head>
    
    <body ontouchstart>
        <header class="ui-header ui-header-positive ui-border-b">
            <i class="ui-icon-return" onclick="history.back()"></i><h1>元器件进销存 </h1><button class="ui-btn">回首页</button>
        </header>
        <footer class="ui-footer ui-footer-btn">
            <ul class="ui-tiled ui-border-t">
                 <li data-href="index.html" class="ui-border-r"><div>进货</div></li>
                   <li data-href="sell.html" class="ui-border-r"><div>出货</div></li>
                   <li data-href="mx.html" class="ui-border-r"><div>明细</div></li>
                   <li data-href="kc.html" class="ui-border-r"><div>库存</div></li>
                  <li data-href="bz.html" class="ui-border-r"><div>帮助</div></li>
            </ul>
        </footer>
        <section class="ui-container">



<section id="list">
      <div class="demo-item">
        <p class="demo-desc">出货</p>
        <div class="demo-block">
            <div class="ui-form ui-border-t">
                <form action="#">
                
                <div class="ui-form-item ui-border-b">
                        <label>元器件分类</label>
                        <div class="ui-select-group">
                            <div class="ui-select" >
                                <select id='categorys' onchange="fun_change()">
                                   
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="ui-form-item ui-form-item-show ui-border-b">
                        <label for="#">库存数量</label>
                        <input id='num' type="text" value="" style="color: red">
                    </div>
                    <div class="ui-form-item ui-border-b">
                        <label>
                           	出库数量
                        </label>
                        <input id='num1' type="text" placeholder="出库数量不得大于库存" />
                        <a href="#" class="ui-icon-close">
                        </a>
                    </div>
                    
                    <div class="ui-form-item ui-border-b">
                        <label>
                           	价格
                        </label>
                        <input id='price' type="text" placeholder="请输入价格" />
                        <a href="#" class="ui-icon-close">
                        </a>
                    </div>
                    <div class="ui-btn-wrap">
               		     <button class="ui-btn-lg ui-btn-primary" onclick="fun_sell()">
		                 		   确定
		                </button>
		            </div>
                </form>
            </div>
        </div>
    </div>
</section>


 
        </section><!-- /.ui-container-->
        <script>
        $(function(){
        	window.app.getjson("categorys?1=123","init_categorys_callback");
        })
      	
        function fun_change(){
        	if( $("#categorys").val()!=null){
        		window.app.getjson("category/"+$("#categorys").val(),"init_category_callback");
        	}
        }
        function init_category_callback(String){
        	var obj = $.parseJSON(String);
        	$("#num").val(obj.num);
        }
        function init_categorys_callback(String){
        	var obj = $.parseJSON(String);
        	$("#categorys").empty();
        	 $("#categorys").append("<option value=''>选择出库的元器件</option>");
        	for(i=0;i<obj.length;i++){
        		$("#categorys").append("<option value='"+obj[i].id+"'>"+obj[i].name+"</option>");
        	}
        }
        
        function fun_sell(){
        	var p="cid="+$("#categorys").val()+"&num="+$("#num1").val()+"&price="+$("#price").val();
        	window.app.getjson("sell?"+p,"sell_callback");
        }
        function sell_callback(result){
        	alert( $.parseJSON(result).tip);
        }
        $('.ui-list li,.ui-tiled li').click(function(){
            if($(this).data('href')){
                location.href= $(this).data('href');
            }
        });
        $('.ui-header .ui-btn').click(function(){
            location.href= 'index.html';
        });
        </script>
    </body>
</html>